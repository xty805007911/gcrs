<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <link rel="icon" href="/assets/images/favicon.png" type="image/png">
  <title>模板页面</title>

    <!--Begin  Page Level  CSS -->
    <link href="/assets/plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet"/>
     <!--End  Page Level  CSS -->
    <link href="/assets/css/icons.css" rel="stylesheet">
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">
    <link href="/assets/css/responsive.css" rel="stylesheet">

<style>
    body,
    html,
    #usermap {
        overflow: hidden;
        width: 100%;
        height: 100%;
        margin: 0;
        font-family: "微软雅黑";
    }
</style>

</head>

<body class="sticky-header">


<!--引入左侧菜单栏-->
<div th:replace="lefter :: lefterBar(activeUrl='index')"></div>

    <!-- main content start-->
<div class="main-content" >
<div th:replace="header :: headerBar"></div>
        <!--body wrapper start-->
        <div class="wrapper" id="app">
            <!--Start row-->
             <div class="row">

                <!-- Start inbox widget-->
                <div class="col-md-8">
                <div class="white-box">
                    <h2 class="header-title"> 地图展示 </h2>
                    <div id="usermap" style="height: 600px;"></div>
                </div>
                
                </div>
                <!-- Start inbox widget-->
                
                <div class="col-md-4">
                    <div class="white-box" >
                        <h2 class="header-title"> 我的取件地点 </h2>
                        <div>
                            大兴区金融界融汇小区
                        </div>
                    </div>
                    
                    </div>
            </div>
            <!--End row-->



        </div>
        <!-- End Wrapper-->


        <!--Start  Footer -->
        <div th:replace="footer :: footerBar"></div>
         <!--End footer -->

       </div>
      <!--End main content -->
</body>
<script src="http://cdn.staticfile.org/vue/2.6.11/vue.min.js"></script>
<script src="http://cdn.staticfile.org/axios/0.19.2/axios.min.js"></script>
<script src="https://api.map.baidu.com/api?type=webgl&v=1.0&ak=DvwyNimy8CXKEZG9Lxeo6G7zxBjxnsz8"></script>
<script>

    var map = new BMapGL.Map('usermap'); // 创建Map实例
    map.centerAndZoom(new BMapGL.Point(116.404, 39.915), 12); // 初始化地图,设置中心点坐标和地图级别
    map.enableScrollWheelZoom(true); // 开启鼠标滚轮缩放
    
    new Vue({
        el: '#app',
        data: {
            ip:"",
            intervalId: null,
            
        },
        methods: {
            init() {

                //1. 获取客户端ip
                 axios.get("https://api.ipify.org/?format=jsonp&callback=?&_=" + Math.random()).then(response => {
                    var ip = response.data.split("\":\"")[1].split("\"})")[0];
                    this.ip = ip;
                    alert("本地ip1:" +this.ip);

                    //2.根据ip获取客户端位置信息
                    axios.get('/test2?ip='+this.ip).then(response => {
                        console.log(response.data)
                    });


                 });

            },


             // 定时刷新数据函数
            dataRefreh() {
            // 计时器正在进行中，退出函数
            if (this.intervalId != null) {
                return;
            }
            // 计时器为空，操作
            this.intervalId = setInterval(() => {
                //console.log("刷新" + new Date());
                //this.init(); //加载数据函数
            }, 100000);
            }, 
            // 停止定时器
            clear() {
            clearInterval(this.intervalId); //清除计时器
            this.intervalId = null; //设置为null
            },
        },
        mounted() {
            this.init();
        },
        created(){
            this.dataRefreh();
        },
        destroyed(){
            // 在页面销毁后，清除计时器
            this.clear();
        }
    });

    
    


</script>
    <!--Begin core plugin -->
    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/plugins/moment/moment.js"></script>
    <script  src="/assets/js/jquery.slimscroll.js "></script>
    <script src="/assets/js/jquery.nicescroll.js"></script>
    <script src="/assets/js/functions.js"></script>


</html>
